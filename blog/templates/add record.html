{% extends "base.html" %}
{% load static %}

{% block css %}
    <link rel="stylesheet" type="text/css" href="{% static "editor/css/wangEditor.min.css" %}" />
    <link rel="stylesheet" type="text/css" href="{% static "css/component.css" %}" />
{% endblock %}
	
{% block main %}
<!-- Main Wrapper -->

	<div id="main-wrapper">
		<div class="container">
			<div class="row">
				<div class="12u">
						<section>
							<header class="major">
								<h2>添加一条记录</h2>
							</header>
                        </section>
				</div>
			</div>
            <div class="row">
				<div class="12u">
                    <section class="content bgcolor-8">
                        <span class="input input--isao">
                            <input class="input__field input__field--isao" type="text" id="input-38">
                            <label class="input__label input__label--isao" for="input-38" data-content="First Name">
                                <span class="input__label-content input__label-content--isao">First Name</span>
                            </label>
                        </span>
                        <span class="input input--isao">
                            <input class="input__field input__field--isao" type="text" id="input-39">
                            <label class="input__label input__label--isao" for="input-39" data-content="Middle Name" style="font-size: large">
                                <span class="input__label-content input__label-content--isao">Middle Name</span>
                            </label>
                        </span>
                        <span class="input input--isao">
                            <input class="input__field input__field--isao" type="text" id="input-40">
                            <label class="input__label input__label--isao" for="input-40" data-content="Last Name">
                                <span class="input__label-content input__label-content--isao">Last Name</span>
                            </label>
                        </span>
                    </section>
                </div>
			</div>
            <div class="row">
				<div class="12u">
                    <div id="div1" style="height: 600px;"><p>请在此输入正文...</p></div>				</div>
			</div>
            <input type="button" value="submit" onclick="sub()">
		</div>
	</div>

    <script type="text/javascript" src="{% static "editor/js/lib/jquery-1.10.2.min.js" %}"></script>
    <script type="text/javascript" src="{% static "editor/js/wangEditor.min.js" %}"></script>
    <script type="text/javascript">
        var count=false;
        // 获取元素
        var div = document.getElementById('div1');
        // 生成编辑器
        var editor = new wangEditor(div);
        editor.config.uploadImgUrl = '/blog/static/files';
        editor.config.uploadImgFileName = 'uploadFileName';//origin:wangEditorh5file
        editor.config.uploadParams = {
            token: 'abcdefg',
            user: 'useruu'
        };
        editor.config.uploadImgFns.onload = function (resultText, xhr) {
            var originalName = editor.uploadImgOriginalName || '';
        };
        editor.create();
        function post(path, params, method) {
            method = method || "post"; // Set method to post by default if not specified.

            // The rest of this code assumes you are not using a library.
            // It can be made less wordy if you use one.
            var form = document.createElement("form");
            form.setAttribute("method", method);
            form.setAttribute("action", path);

            for(var key in params) {
                if(params.hasOwnProperty(key)) {
                    var hiddenField = document.createElement("input");
                    hiddenField.setAttribute("type", "hidden");
                    hiddenField.setAttribute("name", key);
                    hiddenField.setAttribute("value", params[key]);

                    form.appendChild(hiddenField);
                 }
            }
            document.body.appendChild(form);
            form.submit();
        }
        function sub() {
            if (count==false){
                post('/blog/post-record/',{ context:editor.$txt.html() });
                count=true;
            }else{}


        }
    </script>
    <script>
			(function() {
				// trim polyfill : https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/Trim
				if (!String.prototype.trim) {
					(function() {
						// Make sure we trim BOM and NBSP
						var rtrim = /^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;
						String.prototype.trim = function() {
							return this.replace(rtrim, '');
						};
					})();
				}

				[].slice.call( document.querySelectorAll( 'input.input__field' ) ).forEach( function( inputEl ) {
					// in case the input is already filled..
					if( inputEl.value.trim() !== '' ) {
						classie.add( inputEl.parentNode, 'input--filled' );
					}

					// events:
					inputEl.addEventListener( 'focus', onInputFocus );
					inputEl.addEventListener( 'blur', onInputBlur );
				} );

				function onInputFocus( ev ) {
					classie.add( ev.target.parentNode, 'input--filled' );
				}

				function onInputBlur( ev ) {
					if( ev.target.value.trim() === '' ) {
						classie.remove( ev.target.parentNode, 'input--filled' );
					}
				}
			})();
		</script>
{% endblock %}